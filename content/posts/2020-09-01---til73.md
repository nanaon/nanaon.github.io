---
title: ncloud 인스턴스 생성하고 nginx, uwsgi, django, mysql 설치하기
date: "2020-09-01T16:59:32"
template: "post"
draft: false
slug: "til73"
category: "etc"
tags:
  - "til"
  - "ncloud"
description: "개발환경 세팅"
socialImage: "/naon.png"
---

### ncloud 서버 인스턴스 만들기
TBD

### 퍼블릭 IP 생성하기
TBD

### 포트포워드 설정하기
TBD

### 우분투 서버 접속
```
ssh -l root -p {외부 포트 번호} {서버 접속용 공인 IP}
```

최초 접속이라면

"Are you sure you want to continue connecting (yes/no)?"

이라는 문구가 뜰 텐데 yes 입력하고 계속 진행한다.

접속 후 '관리자 비밀번호 확인'에서 얻은 관리자 이름(root)과 비밀번호를 입력한다. 로그인한 상태에서 `passwd` 명령어를 입력하면 비밀번호를 변경할 수 있다.

sudo 명령 실행 시 'sudo: unable to resolve host {호스트 이름}' 같은 메시지가 뜨면 etc 폴더 안 hostname 파일과 hosts 파일을 확인하고 호스트 이름을 통일해준다. hosts에서는 127.0.1.1 옆에 있는 것이 호스트 이름이다.

### nginx 설치
```
sudo apt-get update
```

업데이트 후 nginx 설치

```
$ sudo apt-get install -y nginx
```

nginx 버전을 확인해보자.

```
$ nginx -v
```
```
$ nginx version: nginx/1.10.3 (Ubuntu)
```

브라우저를 켜서 공인 IP 주소로 접속했을 때 아래 화면이 뜨면 nginx 웹서버가 제대로 설치된 것이다. 서버 접속용 공인 IP와는 다르니 주의할 것.

![nginx browser test](/media/ncloud-nginx-browser.png)

### Ubuntu 16.04에 Python 3.8 설치
Python 3.8 설치에 필요한 라이브러리를 먼저 설치한다.

```
$ sudo apt-get install build-essential checkinstall
$ sudo apt-get install libreadline-gplv2-dev libncursesw5-dev libssl-dev \
  libsqlite3-dev tk-dev libgdbm-dev libc6-dev libbz2-dev libffi-dev zlib1g-dev
```

Python 3.8 설치

```
$ cd /opt
$ sudo wget https://www.python.org/ftp/python/3.8.1/Python-3.8.1.tgz
$ sudo tar xzf Python-3.8.1.tgz
```

```
$ cd Python-3.8.1
$ sudo ./configure --enable-optimizations
$ sudo make altinstall
```

버전 확인

```
$ python3.8 -V
```
```
Python 3.8.1
```

`python` 명령어를 쳤을 때 Python 3.8이 기본으로 실행되도록 설정을 바꿔준다.

```
$ update-alternatives --install /usr/bin/python python /usr/local/bin/python3.8 1
```

제대로 설정됐는지 확인해보자. 파이썬 버전 확인 명령어를 아래와 같이 입력한다.

```
$ python -V
```
```
Python 3.8.1
```

설정이 잘 되었다.

[Python 3.8 버전 설치에 도움받은 곳](https://dlehdgml0480.tistory.com/8)

### Django 설치를 위한 가상환경 세팅
virtualenv를 설치한다.

```
$ sudo apt install virtualenv
```

파이썬 3.8을 사용하는 가상환경을 만들어준다. 가상환경 이름은 test로 했다.

```
$ virtualenv test --python=python3.8
```

만든 가상환경을 실행한다.

```
$ source test/bin/activate
```

그런데 이런 에러가 난다. 매뉴얼대로 해도 항상 에러가 나더라. 신기하다.

```
-bash: test/bin/activate: No such file or directory
```

cd test/bin으로 들어가면 activate가 없고 python python3 python3.8 이 세 개만 달랑 있다. [스택 오버플로우](https://stackoverflow.com/questions/41687841/there-is-no-activate-when-i-am-trying-to-run-my-virtual-env/43667899)에서 이 명령어를 써보라길래 일단 입력해봤다.

```
$ python3.8 -m venv test
```

에러인가 하는 메시지가 떠서 다시 test/bin 경로로 들어가봤더니 activate가 생겨있었다...!? 왜지??

```
Unable to symlink '/usr/local/bin/python3.8' to '/root/test/bin/python3.8'
```

이 메시지는 왜 떴는지 모르겠다. 아무튼 `source test/bin/activate` 명령어를 다시 입력하니까 가상환경이 잘 실행됐다. 이제 여기에 장고를 설치해보자.

### Django, uwsgi 설치
Django를 설치해야하므로 pip를 설치한다.

```
$ sudo apt-get install python3-pip
```

pip가 최신 버전(20.2.2)이 아니라고 해서 업그레이드 해줬다.

```
$ pip install --upgrade pip
```

대망의 장고 설치

```
$ pip install django
```

uwsgi 설치

```
$ pip install uwsgi
```

### MySQL 설치
설치할 수 있는 mysql server 버전을 체크한다.

```
$ sudo apt-cache search mysql-server
```

일단 5.7 버전을 설치해준다. 중간에 root 사용자의 패스워드를 설정하는 화면이 나온다. 설정하고 싶은 비밀번호를 입력하면 된다.

```
$ sudo apt-get install mysql-server-5.7
```

헥헥.. 나머지는 내일.. 개발환경 세팅이 제일 어렵다.