---
title: 상태값(state) 다뤄보기
date: "2021-03-12T16:40:32"
template: "post"
draft: false
slug: "til104"
category: "react"
tags:
  - "til"
  - "react"
description: "리액트 상태값"
socialImage: "/naon.png"
---

### 리액트에서 상태값(state)이란?
컴포넌트 내 변경 가능한 데이터 저장소. UI(엘리먼트)에 반영하기 위해 유지해야할 값 묶음이다. 리액트 컴포넌트에 저장한 데이터가 변화하면 UI가 자동으로 갱신된다.

리액트 개발의 핵심은 상태값을 효율적으로 관리하는 것, 그리고 상태값에 따라 화면이 불필요하게 업데이트되지 않도록 관리하는 것이다.

각 컴포넌트 안에서만 사용하는 값은 해당 컴포넌트 안에서 생성하고 갱신한다. 여러 컴포넌트에서 사용하는 값은 별도 공간에서 생성하고 갱신한다.

상태값 관리는 getter/setter 함수로 하고, UI 갱신 문제 등이 있으니 직접 변경하는 것은 지양하자.

### 상태값 변경 예시
클래스형 컴포넌트에서는 항상 **`this.state` 객체를 통해 상태값에 접근**한 뒤, **`this.setState` 함수로 상태값을 변경**해야 한다.

```js
import React from 'react';
import 'App.css';

class Counter1 extends React.Component {
  state = {
    value: this.props.initialValue,
  };  // 새로운 컴포넌트가 만들어질 때마다 수행되는 부분. 초기화한 값(<Counter1 initialValue={ 10 } />)을 받아온다(props)

  onClick = () => {
    // this.state.value += 1;  이렇게 상태값을 직접 변경해주면 안됨

    const value = this.state.value + 1;
    this.setState({ value });  // 파이썬으로 따지면 {"value": value}, JS 다른 표기법으로는 {value: value}와 같다. JS에서 키-값 변수가 같으면 생략 가능하므로 {value}가 된다
  }  // 이벤트 리스너 함수 선언은 <함수명> = () => {}으로 해준다

  render() {
    const { value } = this.state;  // state에 있는 값을 가져와 변수 value에 할당
    return (
      <div>
        Counter1: { value }
        <button onClick={this.onClick}>+1</button>
      </div>
    )
  }
}  // 그 외에는 함수명() {}으로 해준다

function App() {
  return (
    <div>
      <Counter1 initialValue={ 10 } />
    </div>
  );
}

export default App;
```

```js
import React from 'react';
import 'App.css';

class Counter1 extends React.Component {
  state = {
    value: this.props.initialValue,
  };

  onClick = () => {
    this.setState((prevState) => {
      const { value } = prevState;
      return { value: value + 1 };
    });

    this.setState((prevState) => {
      const { value } = prevState;
      return { value: value + 1 };
    });

    this.setState((prevState) => {
      const { value } = prevState;
      return { value: value + 1 };
    });
  };

  render() {
    const { value } = this.state;
    return (
      <div>
        Counter1: { value }
        <button onClick={this.onClick}>+1</button>
      </div>
    );
  }
}

function App() {
  return (
    <div>
      <Counter1 initialValue={ 10 } />
    </div>
  );
}

export default App;
```

```js
import React from 'react';
import 'App.css';

class PostDetail extends React.Component {
    // mount 되고 나서 호출
    componentDidMount() {
        const { postId } = this.props;
        this.requestPost(postId);
    }

    // 업데이트 되었을 떄 호출
    componentDidUpdate(prevProps) {
        const { postId } = this.props;
        if ( postId !== prevProps.postId ) {
            this.requestPost(postId);
        }
    }

    requestPost(postId) {
        console.log(`request post #${postId}`);
    }

    render() {
        const { postId } = this.props;
        return  (
            <div>
                포스팅 #{postId}
                <hr/>
                포스팅 내용...
            </div>
        );
    }
}

class App extends React.Component {

    state = {
        postId: 10
    }

    render() {
        return (
            <div>
                <PostDetail postId = { this.state.postId } />
                <button onClick={() => this.setState({ postId: 20 })}>
                    postId 변경
                </button>
            </div>
        );
    }
}

export default App;

```